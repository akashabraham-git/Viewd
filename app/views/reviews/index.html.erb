<div style="max-width: 800px; margin: 0 auto; padding: 40px 20px; color: #9ab; font-family: sans-serif;">
  
  <div style="display: flex; gap: 20px; align-items: center; margin-bottom: 40px;">
    <%= image_tag @movie.poster_url,
        style: "width: 80px; border-radius: 4px;
                box-shadow: 0 4px 10px rgba(0,0,0,0.5);" %>
    <div>
      <h4 style="color: #678; margin: 0; font-size: 0.8rem;
                 text-transform: uppercase; letter-spacing: 1px;">
        Reviews for
      </h4>
      <h1 style="color: #fff; margin: 0; font-size: 2rem;">
        <%= @movie.title %>
      </h1>
    </div>
  </div>

  <div style="border-top: 1px solid #2c3440;">
    <% @reviews.each do |review| %>

      <div
        onclick="window.location='<%= review_path(review) %>'"
        style="display: flex;
               gap: 20px;
               padding: 30px 0;
               border-bottom: 1px solid #232a33;
               cursor: pointer;">

        <%# AVATAR (PROFILE LINK) %>
        <%= link_to user_path(review.user),
            onclick: "event.stopPropagation();",
            style: "text-decoration:none; flex-shrink:0;" do %>

          <div style="width: 50px; height: 50px;
                      background: #2c3440;
                      border-radius: 50%;
                      overflow: hidden;
                      border: 1px solid #456;">
            <% if review.user.profile_picture.attached? %>
              <%= image_tag review.user.profile_picture,
                  style: "width:100%; height:100%; object-fit:cover;" %>
            <% else %>
              <div style="display:flex;
                          align-items:center;
                          justify-content:center;
                          height:100%;
                          color:#456;
                          font-size:1.2rem;">ðŸ‘¤</div>
            <% end %>
          </div>

        <% end %>

        <div style="flex: 1;">
          <div style="display: flex;
                      justify-content: space-between;
                      align-items: flex-start;">

            <%# NAME + USERNAME + STARS (PROFILE LINK) %>
            <%= link_to user_path(review.user),
                onclick: "event.stopPropagation();",
                style: "text-decoration:none;" do %>

              <div style="display: flex; align-items: center; gap: 10px;">
                <span style="color: #fff;
                             font-weight: bold;
                             font-size: 1.1rem;">
                  <%= review.user.name %>
                </span>

                <span style="color:#678; font-size:0.85rem;">
                  @<%= review.user.username %>
                </span>

                <% rating = Rating.find_by(user: review.user, movie: @movie) %>
                <% if rating %>
                  <div style="display:flex; gap:2px; margin-left:5px;">
                    <% rating.rating.times do %>
                      <span style="color:#00e054; font-size:0.8rem;">â˜…</span>
                    <% end %>
                  </div>
                <% end %>
              </div>

            <% end %>

            <%# DATE + LIKE FORMAT (UNCHANGED) %>
            <div style="text-align: right;">
              <small style="display:block;
                            color:#456;
                            margin-bottom:5px;">
                <%= review.created_at.strftime("%b %d, %Y") %>
              </small>

              <%= button_to toggle_like_movie_review_path(@movie, review),
                    method: :post,
                    onclick: "event.stopPropagation();",
                    style: "background:none;
                            border:none;
                            cursor:pointer;
                            padding:0;
                            display:inline-flex;
                            align-items:center;
                            gap:5px;" do %>

                <span style="color:<%= review.likes.exists?(user: @user) ? '#ff4b4b' : '#678' %>;
                             font-size:1rem;">
                  <%= review.likes.exists?(user: @user) ? 'â¤' : 'â™¡' %>
                </span>

                <span style="color:#678;
                             font-size:0.8rem;
                             font-weight:bold;">
                  <%= review.likes.count %>
                </span>

              <% end %>
            </div>
          </div>

          <%# REVIEW CONTENT (LARGE CLICK AREA) %>
          <div style="margin-top:10px;
                      color:#9ab;
                      line-height:1.6;
                      font-size:1rem;">
            <%= simple_format review.content %>
          </div>

          <% if review.user == @user %>
            <div style="display:flex;
                        gap:15px;
                        margin-top:15px;
                        justify-content:flex-end;">

              <%= link_to "EDIT",
                    edit_movie_review_path(@movie, review),
                    onclick: "event.stopPropagation();",
                    style: "color:#678;
                            text-decoration:none;
                            font-size:0.7rem;
                            font-weight:bold;" %>

              <%= button_to "DELETE",
                    movie_review_path(@movie, review),
                    method: :delete,
                    onclick: "event.stopPropagation();",
                    data: { confirm: "Delete review?" },
                    style: "background:none;
                            border:none;
                            color:#ff4b4b;
                            font-size:0.7rem;
                            font-weight:bold;
                            cursor:pointer;
                            padding:0;" %>
            </div>
          <% end %>
        </div>
      </div>

    <% end %>
  </div>
</div>
